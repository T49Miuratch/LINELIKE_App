<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>YESNOPILLOWONTHEWEB</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Darumadrop+One&family=Dela+Gothic+One&family=DotGothic16&family=Kaisei+Decol:wght@700&family=RocknRoll+One&family=VT323&family=Zen+Kaku+Gothic+New:wght@400;500&display=swap" rel="stylesheet">    
</head>
<body>

<script type="module">

// Import the functions you need from the SDKs you need
import { initializeApp } from "https://www.gstatic.com/firebasejs/9.1.0/firebase-app.js";
import { getDatabase, ref, push, set, onChildAdded, remove, onChildRemoved }
from "https://www.gstatic.com/firebasejs/9.1.0/firebase-database.js";
// Your web app's Firebase configuration
const firebaseConfig = {
  apiKey: "AIzaSyBGbyhwC5HqkFK48Q8Yodt3a-60czlhuHo",
  authDomain: "yesnopillow-5c888.firebaseapp.com",
  projectId: "yesnopillow-5c888",
  storageBucket: "yesnopillow-5c888.appspot.com",
  messagingSenderId: "1005052688361",
  appId: "1:1005052688361:web:cf21f3ddf54cb4416c7d78"
};



// Initialize Firebase
const app = initializeApp(firebaseConfig);
const db = getDatabase(app); //RealtimeDBに接続
const dbRef = ref(db, "chat"); //RealtimeDB内の"chat"を使う

//データ登録(Click)
$("#send").on('click', function () {
    const uname = $("#uname").val();
    const text = $("#text").val();
    // alert(name + text)
});

//データ登録(Enter)

$("#send").on("click",function(){
const msg = {
uname: $("#uname").val(),
text: $("#text").val()
}
const newPostRef = push(dbRef);
set(newPostRef, msg);

$("#uname").val("");
$("#text").val("");

});


//最初にデータ取得＆onSnapshotでリアルタイムにデータを取得
onChildAdded(dbRef, function(data){
    const msg  = data.val(); //オブジェクトデータの取得
    const key  = data.key; //データのユニークキー
    //表示用のテキスト
    let h = '<p>';
        h += msg.uname;
        h += '<br>';
        h += msg.text;
        h += '</p>';
    //ここで画面表示
    $("#output").append(h); //#outputの最後に追加

});

// データ消去

$("#remove").on("click",function() {

    console.log("消去ボタン押された")

    $("#output").val("");

});

</script>

    <main>

<div class="title">
    YESNOPILLOW<br>ONTHEWEB
</div>

<table>
    <tr>
    <td><div><img src="img/characters/ynp_crcts_-05.png" class="boy"></div></td>
    <td><div><img src="img/characters/ynp_crcts_-06.png" class="girl"></div></td>
    </tr>

    <tr>
        <td>
            
            <div class="boys-pillow">
                <img src="img/pillow/qst-pillow.png" alt="?" class="qst-boy" id="pillow">
            </div>

        </td>

        <td>
            
            <div class="girls-pillow">
                <img src="img/pillow/qst-pillow-pink.png" alt="?" class="qst-girl" id="pillow">
            </div>

        </td>

        </tr>


        <tr>
            <td><div class="comment">
                message:<br>
                <textarea id="uname" cols="23" rows="2"></textarea><br>
                <button id="send">send</button>
            
            </div></td>
    
            <td><div class="comment">
                message:<br>
                <textarea id="text" cols="23" rows="2"></textarea><br>
                <button id="send">send</button>
            </div></td>
    
            </tr>

</table>

<p id="message" style="display: none;">MATCH!

    <div id="output" style="display: none;"></div></textarea>

</p>


<!-- テスト -->

    <!-- コンテンツ表示画面 -->
    <!-- <div>

        <div>名前：<input type="text" id="uname"></div>
        <div>
            <textarea id="text" cols="30" rows="10"></textarea>
            <button id="send">送信</button>
            <button id="remove">消去</button>
        </div>
        <div id="output" style="overflow: auto;height: 20px;"></div>
    </div> -->

    </main>

<!-- テスト -->

<!-- jQueryのライブラリを読み込む -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

<!-- JavaScriptのコードを読み込む -->
<script src="js/yesnopillow.js"></script>

</body>
</html>